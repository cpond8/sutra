;; List Atom Tests: car, cdr, cons

(test "car returns first element of list"
  (expect (= (car (list 1 2 3)) 1)))

(test "car returns first string element"
  (expect (= (car (list "a" "b")) "a")))

(test "car errors on empty list"
  (expect (eq? (try (car (list))) (error "car: empty list"))))

(test "car errors on non-list argument"
  (expect (eq? (try (car 42)) (error "car expects a List, found 42"))))

(test "cdr returns tail of list"
  (expect (= (cdr (list 1 2 3)) (list 2 3))))

(test "cdr returns tail with one element"
  (expect (= (cdr (list "a" "b")) (list "b"))))

(test "cdr errors on empty list"
  (expect (eq? (try (cdr (list))) (error "cdr: empty list"))))

(test "cdr errors on non-list argument"
  (expect (eq? (try (cdr 42)) (error "cdr expects a List, found 42"))))

(test "cons prepends element to list"
  (expect (= (cons 1 (list 2 3)) (list 1 2 3))))

(test "cons prepends string to list"
  (expect (= (cons "a" (list "b" "c")) (list "a" "b" "c"))))

(test "cons errors if second argument is not a list"
  (expect (eq? (try (cons 1 2)) (error "cons expects second argument to be a List, found 2"))))

(test "cons errors on wrong arity (one argument)"
  (expect (eq? (try (cons 1)) (error "cons expects 2 arguments, got 1"))))

(test "car errors on wrong arity (no arguments)"
  (expect (eq? (try (car)) (error "car expects 1 argument, got 0"))))

(test "cdr errors on wrong arity (no arguments)"
  (expect (eq? (try (cdr)) (error "cdr expects 1 argument, got 0"))))