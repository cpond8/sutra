# Macro Tests - World State Operations
# Tests for world state management macros

- name: "set! basic assignment"
  input: "(do (set! x 42) (get x))"
  expected: "42"

- name: "set! overwrite value"
  input: "(do (set! y 10) (set! y 20) (get y))"
  expected: "20"

- name: "set! nested path"
  input: "(do (set! player.hp 100) (get player.hp))"
  expected: "100"

- name: "get nonexistent returns nil"
  input: "(get nonexistent)"
  expected: "nil"

- name: "exists? with existing value"
  input: "(do (set! z true) (exists? z))"
  expected: "true"

- name: "exists? with nonexistent value"
  input: "(exists? missing)"
  expected: "false"

- name: "del! remove value"
  input: "(do (set! w 100) (del! w) (exists? w))"
  expected: "false"

- name: "del! returns deleted value"
  input: "(do (set! v 123) (del! v))"
  expected: "123"

- name: "add! numeric increment"
  input: "(do (set! counter 10) (add! counter 5) (get counter))"
  expected: "15"

- name: "sub! numeric decrement"
  input: "(do (set! score 100) (sub! score 25) (get score))"
  expected: "75"

- name: "inc! increment by one"
  input: "(do (set! num 41) (inc! num) (get num))"
  expected: "42"

- name: "dec! decrement by one"
  input: "(do (set! num 43) (dec! num) (get num))"
  expected: "42"

# Error cases
- name: "set! wrong arity"
  input: "(set! x)"
  expect_error_code: "ARITY_ERROR"

- name: "get wrong arity"
  input: "(get)"
  expect_error_code: "ARITY_ERROR"

- name: "add! wrong arity"
  input: "(add! x)"
  expect_error_code: "ARITY_ERROR"
