;; Sutra Math Atom Tests
;;
;; This suite validates the behavior of all mathematical atoms, including
;; standard operations, edge cases, and error conditions as specified in
;; the canonical language reference.

;;;
;;; 1. Addition (+)
;;;

(test "math: + success"
      (expect (value 10) (tags "math"))
      (+ 1 2 3 4))

(test "math: + identity"
      (expect (value 0) (tags "math"))
      (+))

(test "math: + with negatives"
      (expect (value -2) (tags "math"))
      (+ 1 -3))

(test "math: + type error"
      (expect (error TypeError) (tags "math"))
      (+ 1 "two"))

(test "math: + arity error (zero args is identity)"
      (expect (error ArityError) (tags "math") (skip "Demonstration of skip feature for test harness."))
      (+ 1))

;;;
;;; 2. Subtraction (-)
;;;

(test "math: - success"
      (expect (value 1) (tags "math"))
      (- 10 5 4))

(test "math: - unary negation"
      (expect (value -5) (tags "math"))
      (- 5))

(test "math: - arity error"
      (expect (error ArityError) (tags "math"))
      (-))

(test "math: - type error"
      (expect (error TypeError) (tags "math"))
      (- 10 "five"))

;;;
;;; 3. Multiplication (*)
;;;

(test "math: * success"
      (expect (value 24) (tags "math"))
      (* 2 3 4))

(test "math: * identity"
      (expect (value 1) (tags "math"))
      (*))

(test "math: * with zero"
      (expect (value 0) (tags "math"))
      (* 10 20 0))

(test "math: * type error"
      (expect (error TypeError) (tags "math"))
      (* 2 "three"))

(test "math: * arity error (zero args is identity)"
      (expect (error ArityError) (tags "math"))
      (* 5))

;;;
;;; 4. Division (/)
;;;

(test "math: / success"
      (expect (value 2.5) (tags "math") (timeout 1000))
      (/ 10 4))

(test "math: / unary reciprocal"
      (expect (value 0.25) (tags "math"))
      (/ 4))

(test "math: / division by zero"
      (expect (error DivisionByZero) (tags "math"))
      (/ 10 0))

(test "math: / arity error"
      (expect (error ArityError) (tags "math"))
      (/))

(test "math: / type error"
      (expect (error TypeError) (tags "math"))
      (/ 10 "two"))

;;;
;;; 5. Modulo (mod)
;;;

(test "math: mod success"
      (expect (value 1) (tags "math"))
      (mod 10 3))

(test "math: mod arity error - too few"
      (expect (error ArityError) (tags "math"))
      (mod 10))

(test "math: mod arity error - too many"
      (expect (error ArityError) (tags "math"))
      (mod 10 3 1))

(test "math: mod type error"
      (expect (error TypeError) (tags "math"))
      (mod 10 "three"))